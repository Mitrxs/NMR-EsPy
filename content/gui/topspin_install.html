
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Integrating the GUI into TopSpin &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nameko.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using The GUI" href="usage/index.html" />
    <link rel="prev" title="The NMR-EsPy GUI" href="index.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Lora:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usage/index.html" title="Using The GUI"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The NMR-EsPy GUI"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">The NMR-EsPy GUI</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Integrating the GUI into TopSpin</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="integrating-the-gui-into-topspin">
<h1>Integrating the GUI into TopSpin<a class="headerlink" href="#integrating-the-gui-into-topspin" title="Permalink to this heading">¶</a></h1>
<p>It is possible to directly load the NMR-EsPy GUI from within TopSpin. The GUI
can be installed to TopSpin either at the point of installing NMR-EsPy using
<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>, or at any subsequent point.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On this page, <code class="docutils literal notranslate"><span class="pre">&lt;pyexe&gt;</span></code> denotes the symbolic link/path to the Python
executable you are using.</p>
</div>
<section id="automatic-installation">
<h2>Automatic installation<a class="headerlink" href="#automatic-installation" title="Permalink to this heading">¶</a></h2>
<p>After installing NMR-EsPy using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code>, you can set up the TopSpin
GUI loader by entering the following into a terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ &lt;pyexe&gt; -m nmrespy --install-to-topspin
</pre></div>
</div>
<p>The script searches for directories matching the following glob pattern in your
system:</p>
<ul class="simple">
<li><p>UNIX: <code class="docutils literal notranslate"><span class="pre">/opt/topspin*</span></code></p></li>
<li><p>Windows: <code class="docutils literal notranslate"><span class="pre">C:\Bruker\TopSpin*</span></code></p></li>
</ul>
<p>If there are valid directories, you will see a message similar to this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The following TopSpin path(s) were found on your system:
    [1] /opt/topspin3.6.3
    [2] /opt/topspin4.0.8
For each installation that you would like to install the nmrespy app to,
provide the corresponding numbers, separated by whitespaces.
If you want to cancel the install to TopSpin, enter 0.
If you want to install to all the listed TopSpin installations, press &lt;Return&gt;:
</pre></div>
</div>
<p>In this example, if you wanted to install the GUI loader to both TopSpin 3.6.3
and TopSpin 4.0.8, you would enter <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">2</span></code> or simply press <code class="docutils literal notranslate"><span class="pre">&lt;Return&gt;</span></code>. If you
only wanted to install to TopSpin 4.0.8, you would enter <code class="docutils literal notranslate"><span class="pre">2</span></code>. To cancel the
install, enter <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>For each specified path to install to, the script will try to copy the GUI
loader to the path <code class="docutils literal notranslate"><span class="pre">/.../topspin&lt;x.y.z&gt;/exp/stan/nmr/py/user/nmrespy.py</span></code>,
where <code class="docutils literal notranslate"><span class="pre">&lt;x.y.z&gt;</span></code> is the TopSpin version number.</p>
<p>The result of the attempted install will be printed to the terminal. Here is
an example where I try to install to both TopSpin 4.0.8 and TopSpin 3.6.3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SUCCESS:
    /opt/topspin3.6.3/exp/stan/nmr/py/user/nmrespy.py

SUCCESS:
    /opt/topspin4.0.8/exp/stan/nmr/py/user/nmrespy.py
</pre></div>
</div>
</section>
<section id="manual-installation">
<h2>Manual Installation<a class="headerlink" href="#manual-installation" title="Permalink to this heading">¶</a></h2>
<p>If automatic installation failed, perhaps because TopSpin isn’t installed in
the default location, you can still easily get the TopSpin GUI loader
up-and-running with the following steps.</p>
<section id="copying-the-loader-script">
<h3>Copying the loader script<a class="headerlink" href="#copying-the-loader-script" title="Permalink to this heading">¶</a></h3>
<p>Open a terminal/command prompt and enter the following to
determine where the GUI loading script is located:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ &lt;pyexe&gt; -c &quot;import nmrespy; print(nmrespy.TOPSPINPATH)&quot;
/home/simon/.local/lib/python3.9/site-packages/nmrespy/app/_topspin.py
</pre></div>
</div>
<p>Now you simply need to copy this file to your TopSpin installation. You should
rename the copied file as <code class="docutils literal notranslate"><span class="pre">nmrespy.py</span></code>:</p>
<ul>
<li><p>UNIX:</p>
<p>You may need <code class="docutils literal notranslate"><span class="pre">sudo</span></code> depending on where your TopSpin directory is.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cp /home/simon/.local/lib/python3.9/site-packages/nmrespy/app/_topspin.py \
&gt; /path/to/.../topspinx.y.z/exp/stan/nmr/py/user/nmrespy.py
</pre></div>
</div>
</li>
<li><p>Windows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; copy C:\Users\simon\AppData\Roaming\Python\Python38\site-packages\nmrespy\app\_topspin.py ^
More? C:\path\to\...\TopSpinx.y.z\exp\stan\nmr\py\user\nmrespy.py
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the UNIX example, <code class="docutils literal notranslate"><span class="pre">\</span></code> followed by pressing <code class="docutils literal notranslate"><span class="pre">&lt;Return&gt;</span></code> allows
a single long command to span multiple lines. Similarly, <code class="docutils literal notranslate"><span class="pre">^</span></code>, followed
by <code class="docutils literal notranslate"><span class="pre">&lt;Return&gt;</span></code> achieves the same thing in Windows cmd.</p>
</div>
</section>
<section id="editing-the-loader-script">
<h3>Editing the loader script<a class="headerlink" href="#editing-the-loader-script" title="Permalink to this heading">¶</a></h3>
<p>Now you need to open the newly created file:</p>
<ol class="arabic simple">
<li><p>Load TopSpin</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">edpy</span></code> in the bottom-left command prompt</p></li>
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">user</span></code> subdirectory from <code class="docutils literal notranslate"><span class="pre">Source</span></code></p></li>
<li><p>Double click <code class="docutils literal notranslate"><span class="pre">nmrespy.py</span></code></p></li>
</ol>
<ul>
<li><p><strong>Specifying the Python executable path</strong></p>
<p>You need to set <code class="docutils literal notranslate"><span class="pre">py_exe</span></code> (which is <code class="docutils literal notranslate"><span class="pre">None</span></code> initially) with the path to
your Python executable. One way to determine this which should be independent
of Operating System is to load a Python interpreter or write a script with
the following lines (below is an example on Windows):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exe</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># replace is needed for Windows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">exe</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&quot;C:\\Users\\simon\\AppData\\Local\\Programs\\Python\\Python38\\python.exe&quot;</span>
</pre></div>
</div>
<p>You should set <code class="docutils literal notranslate"><span class="pre">py_exe</span></code> as the <strong>EXACT</strong> output you get from this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">py_exe</span> <span class="o">=</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">simon</span><span class="se">\\</span><span class="s2">AppData</span><span class="se">\\</span><span class="s2">Local</span><span class="se">\\</span><span class="s2">Programs</span><span class="se">\\</span><span class="s2">Python</span><span class="se">\\</span><span class="s2">Python38</span><span class="se">\\</span><span class="s2">python.exe&quot;</span>
</pre></div>
</div>
</li>
<li><p><strong>(Optional) Specifying the pdflatex path</strong></p>
<p>If you have <code class="docutils literal notranslate"><span class="pre">pdflatex</span></code> on your system (see the <em>LaTeX</em> section in
<a class="reference internal" href="../install.html"><span class="doc">Installation</span></a>), and you want to be able to produce
PDF result files, you will also have to specify the path to the
<code class="docutils literal notranslate"><span class="pre">pdflatex</span></code> executable, given by the variable <code class="docutils literal notranslate"><span class="pre">pdflatex_exe</span></code>, which
is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> by default. To find this path, load a Python interpreter/
write a Python script with the following lines:</p>
<ul>
<li><p><em>UNIX</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">check_output</span> <span class="k">as</span> <span class="n">co</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exe</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;which pdflatex&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exe</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">exe</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&quot;/usr/bin/pdflatex&quot;</span>
</pre></div>
</div>
</li>
<li><p><em>Windows</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">check_output</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exe</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;where pdflatex&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exe</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">exe</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&quot;C:\\texlive\\2020\\bin\\win32\\pdflatex.exe&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p>You should set <code class="docutils literal notranslate"><span class="pre">pdflatex_exe</span></code> as the <strong>EXACT</strong> output you get from this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pdflatex_exe</span> <span class="o">=</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">texlive</span><span class="se">\\</span><span class="s2">2020</span><span class="se">\\</span><span class="s2">bin</span><span class="se">\\</span><span class="s2">win32</span><span class="se">\\</span><span class="s2">pdflatex.exe&quot;</span>
</pre></div>
</div>
</li>
</ul>
<p>With the Python path and (optionally) the <code class="docutils literal notranslate"><span class="pre">pdflatex</span></code> path set, the script
should now work.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><style>
.aligncenter {
    text-align: center;
}
</style>

<a href="https://foroozandehgroup.github.io/NMR-EsPy/">
    <img style="padding: 0px 0px 12px"
         src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/nmrespy_full.png"
         alt="NMR-EsPy logo"
         width=230px
         height=auto />
</a>

<p class="aligncenter">
    <a href="https://github.com/foroozandehgroup/NMR-EsPy">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/github.png"
             alt="Github"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

    <a href="mailto:simon.hulse@chem.ox.ac.uk?subject=NMR-EsPy%20query">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/email_icon.png"
             alt="email"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

    <a href="https://foroozandeh.chem.ox.ac.uk/home">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/develop/nmrespy/images/link.png"
             alt="Group website"
             width=auto
             height=30px />
    </a>
</p>
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Integrating the GUI into TopSpin</a><ul>
<li><a class="reference internal" href="#automatic-installation">Automatic installation</a></li>
<li><a class="reference internal" href="#manual-installation">Manual Installation</a><ul>
<li><a class="reference internal" href="#copying-the-loader-script">Copying the loader script</a></li>
<li><a class="reference internal" href="#editing-the-loader-script">Editing the loader script</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div><h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation index</a><ul>
  <li><a href="index.html">The NMR-EsPy GUI</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">The NMR-EsPy GUI</a></li>
      <li>Next: <a href="usage/index.html" title="next chapter">Using The GUI</a></li>
  </ul></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/content/gui/topspin_install.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
  </body>
</html>