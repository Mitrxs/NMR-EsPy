
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>nmrespy.Estimator2DJ &#8212; NMR-EsPy  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nameko.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="nmrespy.load" href="load.html" />
    <link rel="prev" title="nmrespy.Estimator1D" href="estimator1d.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Lora:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="load.html" title="nmrespy.load"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="estimator1d.html" title="nmrespy.Estimator1D"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">NMR-EsPy  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">nmrespy.Estimator2DJ</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <style>
   .grey {color:#808080}
   .red {color:#ff0000}
   .green {color:#008000}
   .blue {color:#0000ff}
   .oscblue {color:#1063e0}
   .oscorange {color:#eb9310}
   .oscgreen {color:#2bb539}
   .oscred {color:#d4200c}
   .regiongreen {color: #7fd47f}
   .regionblue {color: #66b3ff}
</style><section id="nmrespy-estimator2dj">
<h1>nmrespy.Estimator2DJ<a class="headerlink" href="#nmrespy-estimator2dj" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nmrespy.</span></span><span class="sig-name descname"><span class="pre">Estimator2DJ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expinfo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datapath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a class instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – The data associated with the binary file in <cite>path</cite>.</p></li>
<li><p><strong>datapath</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – The path to the directory containing the NMR data.</p></li>
<li><p><strong>expinfo</strong> (<a class="reference internal" href="expinfo.html#nmrespy.ExpInfo" title="nmrespy.ExpInfo"><em>ExpInfo</em></a>) – Experiment information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.add_oscillators">
<span class="sig-name descname"><span class="pre">add_oscillators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">estimate_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.add_oscillators" title="Permalink to this definition">¶</a></dt>
<dd><p>Add oscillators to an estimation result.</p>
<p>Optimisation is carried out afterwards, on the updated set of oscillators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>ndarray</em>) – <p>The parameters of new oscillators to be added. Should be of shape
<code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">self.dim))</span></code>, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of new
oscillators to add. Even when one oscillator is being added this
should be a 2D array, i.e.:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">oscillators</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span> <span class="n">φ</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">η</span><span class="p">]])</span>
</pre></div>
</div>
</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the result to edit. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the
first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the
next, etc. By default, the most recently obtained result will be
edited.</p></li>
<li><p><strong>estimate_kwargs</strong> – Keyword arguments to provide to the call to <a class="reference internal" href="#nmrespy.Estimator2DJ.estimate" title="nmrespy.Estimator2DJ.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a>. Note
that <code class="docutils literal notranslate"><span class="pre">&quot;region&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">noise_region&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;initial_guess&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;region_unit&quot;</span></code> are set internally and will be ignored if given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.bf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.bf" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the basic frequency (MHz).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.bruker_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bruker_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.bruker_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of Bruker parameters.</p>
<p>If the class instance was generated by <code class="xref py py-meth docutils literal notranslate"><span class="pre">new_bruker()</span></code>, a
dictionary of experiment parameters will be returned. Otherwise,
<code class="docutils literal notranslate"><span class="pre">None</span></code> will be returned.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data associated with the estimator.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.default_pts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_pts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.default_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get default points associated with each dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.dim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of dimensions in the experiment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_region</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ppm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss-newton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpm_trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlp_trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate a specified region in F2.</p>
<p>The basic steps that this method carries out are:</p>
<ul class="simple">
<li><p>(Optional, but highly advised) Generate a frequency-filtered signal
corresponding to the specified region.</p></li>
<li><p>(Optional) Generate an inital guess using the Matrix Pencil Method (MPM).</p></li>
<li><p>Apply numerical optimisation to determine a final estimate of the signal
parameters</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>region</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>]</em><em>, </em><em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – The frequency range of interest in F2. Should be of the form
<code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code> where <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code> are the left and right
bounds of the region of interest. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the full signal will be
considered, though for sufficently large and complex signals it is
probable that poor and slow performance will be realised.</p></li>
<li><p><strong>noise_region</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>]</em><em>, </em><em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>]</em><em>]</em><em>]</em>) – If <code class="docutils literal notranslate"><span class="pre">region</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, this must be of the form <code class="docutils literal notranslate"><span class="pre">(left,</span> <span class="pre">right)</span></code>
too. This should specify a frequency range in F2 where no noticeable
signals reside, i.e. only noise exists.</p></li>
<li><p><strong>region_unit</strong> (<em>str</em>) – One of <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>. Specifies the units that <code class="docutils literal notranslate"><span class="pre">region</span></code> and
<code class="docutils literal notranslate"><span class="pre">noise_region</span></code> have been given as.</p></li>
<li><p><strong>initial_guess</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>ndarray</em><em>, </em><em>int</em><em>]</em><em>]</em>) – If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an initial guess will be generated using the MPM,
with the Minimum Descritpion Length being used to estimate the
number of oscilltors present. If and int, the MPM will be used to
compute the initial guess with the value given being the number of
oscillators. If a NumPy array, this array will be used as the initial
guess.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>Specifies the optimisation method.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;exact&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-trustconstr.html#optimize-minimize-trustconstr">trust-constr routine</a>
The Hessian will be exact.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;gauss-newton&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-trustconstr.html#optimize-minimize-trustconstr">trust-constr routine</a>
The Hessian will be approximated based on the
<a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Newton_algorithm">Gauss-Newton method</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;lbfgs&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-lbfgsb.html#optimize-minimize-lbfgsb">L-BFGS-B routine</a>.</p></li>
</ul>
</p></li>
<li><p><strong>phase_variance</strong> (<em>bool</em>) – Whether or not to include the variance of oscillator phases in the cost
function. This should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> in cases where the signal being
considered is derived from well-phased data.</p></li>
<li><p><strong>max_iterations</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – A value specifiying the number of iterations the routine may run
through before it is terminated. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default number
of maximum iterations is set (<code class="docutils literal notranslate"><span class="pre">100</span></code> if <code class="docutils literal notranslate"><span class="pre">method</span></code> is
<code class="docutils literal notranslate"><span class="pre">&quot;exact&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;gauss-newton&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">500</span></code> if <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> is
<code class="docutils literal notranslate"><span class="pre">&quot;lbfgs&quot;</span></code>).</p></li>
<li><p><strong>mpm_trim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Specifies the maximal size in the direct dimension allowed for the
filtered signal when undergoing the Matrix Pencil. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no
trimming is applied to the signal. If an int, and the direct
dimension filtered signal has a size greater than <code class="docutils literal notranslate"><span class="pre">mpm_trim</span></code>,
this signal will be set as <code class="docutils literal notranslate"><span class="pre">signal[:,</span> <span class="pre">:mpm_trim]</span></code>.</p></li>
<li><p><strong>nlp_trim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Specifies the maximal size allowed in the direct dimension for the
filtered signal when undergoing nonlinear programming. By default
(<code class="docutils literal notranslate"><span class="pre">None</span></code>), no trimming is applied to the signal. If an int, and
the direct dimension filtered signal has a size greater than
<code class="docutils literal notranslate"><span class="pre">nlp_trim</span></code>, this signal will be set as <code class="docutils literal notranslate"><span class="pre">signal[:,</span> <span class="pre">:nlp_trim]</span></code>.</p></li>
<li><p><strong>fprint</strong> (<em>bool</em>) – Whether of not to output information to the terminal.</p></li>
<li><p><strong>_log</strong> (<em>bool</em>) – Ignore this!</p></li>
<li><p><strong>cut_ratio</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.find_spurious_oscillators">
<span class="sig-name descname"><span class="pre">find_spurious_oscillators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.find_spurious_oscillators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.find_spurious_oscillators" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict which oscillators are spurious.</p>
<p>This predicts the multiplet structures in the estimationm result, and then
purges all oscillators which fall into the following criteria:</p>
<ul class="simple">
<li><p>The oscillator is the only one in the multiplet.</p></li>
<li><p>The frequency in F1 is greater than <code class="docutils literal notranslate"><span class="pre">thold</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Frequency threshold within which <img class="math" src="../../_images/math/9078a9bb13d58bcc9e39c4e4ef18d5cd1ed96dbd.png" alt="f_2 - f_1"/> of the oscillators
in a multiplet should agree. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this is set to be
<img class="math" src="../../_images/math/a4e5f0bc012bdfea5af173489060178cca721b3a.png" alt="N_1 / 2 f_{\mathrm{sw}, 1}`"/></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>A dictionary with int keys corresponding to result indices, and list</em></p></li>
<li><p><em>values corresponding to oscillators which are deemed spurious.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, <em>Iterable</em>[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.fn_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fn_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.fn_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Get acquisiton mode in indirect dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.from_pickle">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.from_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a pickled estimator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – The path to the pickle file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>estimator</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Estimator</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><cite>From the Python docs:</cite></p>
<p><em>“The pickle module is not secure. Only unpickle data you trust.
It is possible to construct malicious pickle data which will
execute arbitrary code during unpickling. Never unpickle data
that could have come from an untrusted source, or that could have
been tampered with.”</em></p>
<p>You should only use <a class="reference internal" href="#nmrespy.Estimator2DJ.from_pickle" title="nmrespy.Estimator2DJ.from_pickle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_pickle()</span></code></a> on files that
you are 100% certain were generated using
<a class="reference internal" href="#nmrespy.Estimator2DJ.to_pickle" title="nmrespy.Estimator2DJ.to_pickle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_pickle()</span></code></a>. If you load pickled data from a .pkl file,
and the resulting output is not an instance of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Estimator</span></code>, an error will be raised.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Estimator.to_pickle()</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_errors">
<span class="sig-name descname"><span class="pre">get_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f-1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return estimation result errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to extract errors from. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to
the first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to
the next, etc.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be used.</p></li>
<li><p><strong>merge</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a single array of all parameters from each specified
estiamtion result specified will be returned. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, an iterable
of each individual estimation result’s parameters will be returned.</p></li>
<li><p><strong>funit</strong> (<em>str</em>) – The unit to express frequencies in. Must be one of <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p></li>
<li><p><strong>sort_by</strong> (<em>str</em>) – Specifies the parameter by which the oscillators are ordered by.
Should be one of <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> for amplitudes <code class="docutils literal notranslate"><span class="pre">&quot;p&quot;</span></code> for phase, <code class="docutils literal notranslate"><span class="pre">&quot;f&lt;n&gt;&quot;</span></code>
for frequency in the <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code>-th dimension, <code class="docutils literal notranslate"><span class="pre">&quot;d&lt;n&gt;&quot;</span></code> for the damping
factor in the <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code>-th dimension. By setting <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">-1</span></code>, the
final (direct) dimension will be used. For 1D data, <code class="docutils literal notranslate"><span class="pre">&quot;f&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code>
can be used to specify the frequency or damping factor.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Optional</em>[<em>Union</em>[<em>Iterable</em>[<em>ndarray</em>], <em>ndarray</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_log">
<span class="sig-name descname"><span class="pre">get_log</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the log for the estimator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f-1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return estimation result parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to extract parameters from. Index <code class="docutils literal notranslate"><span class="pre">0</span></code>
corresponds to the first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code>
corresponds to the next, etc.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be
used.</p></li>
<li><p><strong>merge</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a single array of all parameters from each specified
estiamtion result specified will be returned. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, an iterable
of each individual estimation result’s parameters will be returned.</p></li>
<li><p><strong>funit</strong> (<em>str</em>) – The unit to express frequencies in. Must be one of <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p></li>
<li><p><strong>sort_by</strong> (<em>str</em>) – Specifies the parameter by which the oscillators are ordered by.
Should be one of <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> for amplitudes <code class="docutils literal notranslate"><span class="pre">&quot;p&quot;</span></code> for phase, <code class="docutils literal notranslate"><span class="pre">&quot;f&lt;n&gt;&quot;</span></code>
for frequency in the <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code>-th dimension, <code class="docutils literal notranslate"><span class="pre">&quot;d&lt;n&gt;&quot;</span></code> for the damping
factor in the <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code>-th dimension. By setting <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">-1</span></code>, the
final (direct) dimension will be used. For 1D data, <code class="docutils literal notranslate"><span class="pre">&quot;f&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code>
can be used to specify the frequency or damping factor.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Optional</em>[<em>Union</em>[<em>Iterable</em>[<em>ndarray</em>], <em>ndarray</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a subset of the estimation results obtained.</p>
<p>By default, all results are returned, in the order in which they are obtained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to return. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the first
result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the next, etc.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be returned.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[<em>Result</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_shifts">
<span class="sig-name descname"><span class="pre">get_shifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct chemical shifts which reflect the experiment parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The number of points to construct the time-points with in each dimesnion.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, and <code class="docutils literal notranslate"><span class="pre">self.default_pts</span></code> is a tuple of ints, it will be
used.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – Must be <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p></li>
<li><p><strong>flip</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the shifts will be returned in descending order, as is
conventional in NMR. If <cite>False</cite>, the shifts will be in ascending order.</p></li>
<li><p><strong>meshgrid</strong> (<em>bool</em>) – If time-points are being derived for a N-dimensional signal (N &gt; 1),
setting this argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> will return N-dimensional arrays
corresponding to all combinations of points in each dimension.
plot/contour plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[<em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.get_timepoints">
<span class="sig-name descname"><span class="pre">get_timepoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meshgrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.get_timepoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct time-points which reflect the experiment parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pts</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The number of points to construct the time-points with in each dimesnion.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, and <code class="docutils literal notranslate"><span class="pre">self.default_pts</span></code> is a tuple of ints, it will be
used.</p></li>
<li><p><strong>start_time</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>Union</em><em>[</em><em>float</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>) – The start time in each dimension. If set to <cite>None</cite>, the initial
point in each dimension with be <code class="docutils literal notranslate"><span class="pre">0.0</span></code>. To set non-zero start times,
a list of floats or strings can be used. If floats are used, they
specify the first value in each dimension in seconds. Alternatively,
strings of the form <code class="docutils literal notranslate"><span class="pre">f'{N}dt'</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is an integer, may be
used, which indicates a cetain multiple of the difference in time
between two adjacent points.</p></li>
<li><p><strong>meshgrid</strong> (<em>bool</em>) – If time-points are being derived for a N-dimensional signal (N &gt; 1),
setting this argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> will return N-dimensional arrays
corresponding to all combinations of points in each dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[<em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.latex_nuclei">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">latex_nuclei</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.latex_nuclei" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the nuclei associated with each channel with for use in LaTeX.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expinfo</span> <span class="o">=</span> <span class="n">ExpInfo</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">nuclei</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;1H&quot;</span><span class="p">,</span> <span class="s2">&quot;15N&quot;</span><span class="p">),</span> <span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expinfo</span><span class="o">.</span><span class="n">latex_nuclei</span>
<span class="go">(&#39;\textsuperscript{1}H&#39;, &#39;\textsuperscript{15}N&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.make_fid">
<span class="sig-name descname"><span class="pre">make_fid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect_modulation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.make_fid" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a noiseless FID from estimation result parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to extract errors from. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to
the first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to
the next, etc.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be used.</p></li>
<li><p><strong>pts</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The number of points to construct the time-points with in each dimesnion.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, and <code class="docutils literal notranslate"><span class="pre">self.default_pts</span></code> is a tuple of ints, it will be
used.</p></li>
<li><p><strong>indirect_modulation</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – <p>Acquisition mode in indirect dimension of a 2D experiment. If the
data is not 1-dimensional, this should be one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - <img class="math" src="../../_images/math/e2255bd530b593390504c4be3449a2efb0a6a39f.png" alt="y \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;amp&quot;</span></code> - amplitude modulated pair:
<img class="math" src="../../_images/math/ea3b49cd1866d6f602e5f2e18fedce2af7a2b6af.png" alt="y_{\mathrm{cos}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
\cos\left(\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1\right)
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/>
<img class="math" src="../../_images/math/2a5c653b99bf5f24d8e06a778733662e11d4a818.png" alt="y_{\mathrm{sin}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
\sin\left(\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1\right)
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;phase&quot;</span></code> - phase-modulated pair:
<img class="math" src="../../_images/math/38c167178186e5ad68de50fa832f246766367f80.png" alt="y_{\mathrm{P}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/>
<img class="math" src="../../_images/math/12ad51a67cadbb849ef3ffe4bc0faf6382a4cf59.png" alt="y_{\mathrm{N}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(-2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code> will lead to an array of shape <code class="docutils literal notranslate"><span class="pre">(*pts)</span></code>. <code class="docutils literal notranslate"><span class="pre">amp</span></code> and <code class="docutils literal notranslate"><span class="pre">phase</span></code>
will lead to an array of shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">*pts)</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.merge_oscillators">
<span class="sig-name descname"><span class="pre">merge_oscillators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oscillators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">estimate_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.merge_oscillators" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge oscillators in an estimation result.</p>
<p>Removes the osccilators specified, and constructs a single new
oscillator with a cumulative amplitude, and averaged phase,
frequency and damping. Then runs optimisation on the updated set of
oscillators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oscillators</strong> (<em>Iterable</em><em>[</em><em>int</em><em>]</em>) – A list of indices corresponding to the oscillators to be merged.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the result to edit. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the
first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the
next, etc. By default, the most recently obtained result will be
edited.</p></li>
<li><p><strong>estimate_kwargs</strong> – Keyword arguments to provide to the call to <a class="reference internal" href="#nmrespy.Estimator2DJ.estimate" title="nmrespy.Estimator2DJ.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a>. Note
that <code class="docutils literal notranslate"><span class="pre">&quot;initial_guess&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;region_unit&quot;</span></code> are set internally and
will be ignored if given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Assuming that an estimation result contains a subset of oscillators
denoted by indices <img class="math" src="../../_images/math/3c3ebd66618fd8a5f86f96526f73046daa622d7e.png" alt="\{m_1, m_2, \cdots, m_J\}"/>, where <img class="math" src="../../_images/math/a486bd6628bc141f4083f33b955f8c91a39ca7eb.png" alt="J
\leq M"/>, the new oscillator formed by the merging of the oscillator
subset will possess the following parameters prior to re-running estimation:</p>
<blockquote>
<div><ul class="simple">
<li><p><img class="math" src="../../_images/math/35ef3db46e043f1bee1d4fe19d542f064e5971e7.png" alt="a_{\mathrm{new}} = \sum_{i=1}^J a_{m_i}"/></p></li>
<li><p><img class="math" src="../../_images/math/7ea789c48046fff07ad060dc8f3ce5c859677f9c.png" alt="\phi_{\mathrm{new}} = \frac{1}{J} \sum_{i=1}^J
\phi_{m_i}"/></p></li>
<li><p><img class="math" src="../../_images/math/dd6ae46afa1f39d8499a14a969958f95acf20a0b.png" alt="f_{\mathrm{new}} = \frac{1}{J} \sum_{i=1}^J f_{m_i}"/></p></li>
<li><p><img class="math" src="../../_images/math/7fe3a6b767daa400becd07a88533b818439d7739.png" alt="\eta_{\mathrm{new}} = \frac{1}{J} \sum_{i=1}^J
\eta_{m_i}"/></p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.negative_45_signal">
<span class="sig-name descname"><span class="pre">negative_45_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.negative_45_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.negative_45_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the synthetic signal <img class="math" src="../../_images/math/1edee2e9488d659733ca5917e79bf7114051bd10.png" alt="y_{-45^{\circ}}(t)"/>, where
<img class="math" src="../../_images/math/f2d022ccbf50bf29d1eb6c2c456e8fe9c67af490.png" alt="t \geq 0"/>:</p>
<div class="math">
<p><img src="../../_images/math/fba16d8d367ba2a5baa613eca115e25c91dad073.png" alt="y_{-45^{\circ}}(t) = \sum_{m=1}^M a_m \exp\left( \mathrm{i} \phi_m \right)
\exp\left( 2 \mathrm{i} \pi f_{1,m} t \right)
\exp\left( -t \left[2 \mathrm{i} \pi f_{2,m} + \eta_{2,m} \right] \right)"/></p>
</div><img alt="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/2dj/nmrespy/images/neg_45.png#noqa:E501" src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/2dj/nmrespy/images/neg_45.png#noqa:E501" />
<p>Producing this signal from parameters derived from estimation of a 2DJ dataset
should generate a 1D homodecoupled spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to include. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the first
result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the next, etc.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be included.</p></li>
<li><p><strong>pts</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of points to construct the signal from. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">self.default_pts</span></code> will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.new_synthetic_from_simulation">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">new_synthetic_from_simulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spin_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_widths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1H'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ppm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.new_synthetic_from_simulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.new_synthetic_from_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an estimator with data derived from a J-resolved experiment
simulation.</p>
<p>Simulations are performed using
<a class="reference external" href="https://foroozandehgroup.github.io/nmr_sims/content/references/experiments/pa.html#nmr_sims.experiments.jres.JresEstimator">nmr_sims.experiments.jres.JresEstimator</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spin_system</strong> (<em>SpinSystem</em>) – Specification of the spin system to run simulations on. <a class="reference external" href="https://foroozandehgroup.github.io/nmr_sims/content/references/spin_system.html#nmr_sims.spin_system.SpinSystem.__init__">See here</a>
for more details.</p></li>
<li><p><strong>sweep_widths</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – The sweep width in each dimension. The first element, corresponding
to F1, should be in Hz. The second element, corresponding to F2,
should be expressed in the unit which corresponds to <code class="docutils literal notranslate"><span class="pre">f2_unit</span></code>.</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – The transmitter offset. The value’s unit should correspond with
<code class="docutils literal notranslate"><span class="pre">f2_unit</span></code>.</p></li>
<li><p><strong>pts</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The number of points sampled in each dimension.</p></li>
<li><p><strong>channel</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Nucleus</em><em>]</em>) – Nucleus targeted in the experiment simulation. ¹H is set as the default.
<a class="reference external" href="https://foroozandehgroup.github.io/nmr_sims/content/references/nuclei.html">See here</a> for more information.</p></li>
<li><p><strong>f2_unit</strong> (<em>str</em>) – The unit that the sweep width and transmitter offset in F2 are given in.
Should be either <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code>.</p></li>
<li><p><strong>snr</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The signal-to-noise ratio of the resulting signal, in decibels. <code class="docutils literal notranslate"><span class="pre">None</span></code>
produces a noiseless signal.</p></li>
<li><p><strong>lb</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – The damping (line-broadening) factor applied to the simulated FID.
By default, this will be set to ensure that the final point in each
dimension in scaled to be 1/1000 of it’s un-damped value.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#nmrespy.Estimator2DJ" title="nmrespy.estimators.jres.Estimator2DJ"><em>Estimator2DJ</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.nuclei">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nuclei</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.nuclei" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the nuclei associated with each channel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transmitter offset frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unit</strong> (<em>str</em>) – Must be <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.predict_multiplets">
<span class="sig-name descname"><span class="pre">predict_multiplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.predict_multiplets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.predict_multiplets" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the estimated oscillators which correspond to each multiplet
in the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>thold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – <p>Frequency threshold. All oscillators that make up a multiplet are assumed
to obey the following expression:</p>
<div class="math">
<p><img src="../../_images/math/2f24ea81a52aa392e7ae2ca29c627aca9255b850.png" alt="f_c - f_t &lt; f_{2,m} - f_{1,m} &lt; f_c - f_t"/></p>
</div><p>where <img class="math" src="../../_images/math/f3c754ede5a325f045a10fe57b2f387ad53341c4.png" alt="f_c"/> is the central frequency of the multiplet, and <cite>f_t</cite> is
<code class="docutils literal notranslate"><span class="pre">thold</span></code></p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[<em>Iterable</em>[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.remove_oscillators">
<span class="sig-name descname"><span class="pre">remove_oscillators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oscillators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">estimate_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.remove_oscillators" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove oscillators from an estimation result.</p>
<p>Optimisation is carried out afterwards, on the updated set of oscillators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oscillators</strong> (<em>Iterable</em><em>[</em><em>int</em><em>]</em>) – A list of indices corresponding to the oscillators to be removed.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the result to edit. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the
first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the
next, etc. By default, the most recently obtained result will be
edited.</p></li>
<li><p><strong>estimate_kwargs</strong> – Keyword arguments to provide to the call to <a class="reference internal" href="#nmrespy.Estimator2DJ.estimate" title="nmrespy.Estimator2DJ.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a>. Note
that <code class="docutils literal notranslate"><span class="pre">&quot;initial_guess&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;region_unit&quot;</span></code> are set internally and
will be ignored if given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.remove_spurious_oscillators">
<span class="sig-name descname"><span class="pre">remove_spurious_oscillators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">estimate_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.remove_spurious_oscillators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.remove_spurious_oscillators" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to remove spurious oscillators from the estimation result.</p>
<p>See <a class="reference internal" href="#nmrespy.Estimator2DJ.find_spurious_oscillators" title="nmrespy.Estimator2DJ.find_spurious_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_spurious_oscillators()</span></code></a> for information on how spurious
oscillators are predicted.</p>
<p>Oscillators deemed spurious are removed using <a class="reference internal" href="#nmrespy.Estimator2DJ.remove_oscillators" title="nmrespy.Estimator2DJ.remove_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_oscillators()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thold</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Frequency threshold within which <img class="math" src="../../_images/math/9078a9bb13d58bcc9e39c4e4ef18d5cd1ed96dbd.png" alt="f_2 - f_1"/> of the oscillators
in a multiplet should agree. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this is set to be
<img class="math" src="../../_images/math/a4e5f0bc012bdfea5af173489060178cca721b3a.png" alt="N_1 / 2 f_{\mathrm{sw}, 1}`"/></p></li>
<li><p><strong>estimate_kwargs</strong> – Keyword arguments to provide to <a class="reference internal" href="#nmrespy.Estimator2DJ.remove_oscillators" title="nmrespy.Estimator2DJ.remove_oscillators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_oscillators()</span></code></a>. Note
that <code class="docutils literal notranslate"><span class="pre">&quot;initial_guess&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;region_unit&quot;</span></code> are set internally and
will be ignored if given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.save_log">
<span class="sig-name descname"><span class="pre">save_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./espy_logfile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.save_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the estimator’s log.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – The path to save the log to.</p></li>
<li><p><strong>force_overwrite</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">path</span></code> already exists, <code class="docutils literal notranslate"><span class="pre">force_overwrite</span></code> set to <code class="docutils literal notranslate"><span class="pre">True</span></code> will get
the user to confirm whether they are happy to overwrite the file.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the file will be overwritten without prompt.</p></li>
<li><p><strong>fprint</strong> (<em>bool</em>) – Specifies whether or not to print infomation to the terminal.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.sfo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sfo</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.sfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transmitter frequency (MHz).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.sheared_signal">
<span class="sig-name descname"><span class="pre">sheared_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indirect_modulation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.sheared_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.sheared_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an FID where direct dimension frequencies are perturbed such that:</p>
<div class="math">
<p><img src="../../_images/math/54ce103fb4c2921775de11cb939ce19a30eca6eb.png" alt="f_{2, m} = f_{2, m} - f_{1, m}\ \forall\ m \in \{1, \cdots, M\}"/></p>
</div><p>This should yeild a signal where all components in a multiplet are centered
at the spin’s chemical shift in the direct dimenion, akin to “shearing” 2DJ
data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to include. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the first
result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the next, etc.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be included.</p></li>
<li><p><strong>pts</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – The number of points to construct the signal from. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">self.default_pts</span></code> will be used.</p></li>
<li><p><strong>indirect_modulation</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – <p>Acquisition mode in indirect dimension of a 2D experiment. If the
data is not 1-dimensional, this should be one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - <img class="math" src="../../_images/math/e2255bd530b593390504c4be3449a2efb0a6a39f.png" alt="y \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;amp&quot;</span></code> - amplitude modulated pair:
<img class="math" src="../../_images/math/ea3b49cd1866d6f602e5f2e18fedce2af7a2b6af.png" alt="y_{\mathrm{cos}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
\cos\left(\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1\right)
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/>
<img class="math" src="../../_images/math/2a5c653b99bf5f24d8e06a778733662e11d4a818.png" alt="y_{\mathrm{sin}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
\sin\left(\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1\right)
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;phase&quot;</span></code> - phase-modulated pair:
<img class="math" src="../../_images/math/38c167178186e5ad68de50fa832f246766367f80.png" alt="y_{\mathrm{P}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/>
<img class="math" src="../../_images/math/12ad51a67cadbb849ef3ffe4bc0faf6382a4cf59.png" alt="y_{\mathrm{N}} \left(t_1, t_2\right) = \sum_{m} a_m
e^{\mathrm{i} \phi_m}
e^{\left(-2 \pi \mathrm{i} f_{1, m} - \eta_{1, m}\right) t_1}
e^{\left(2 \pi \mathrm{i} f_{2, m} - \eta_{2, m}\right) t_2}"/></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code> will lead to an array of shape <code class="docutils literal notranslate"><span class="pre">(*pts)</span></code>. <code class="docutils literal notranslate"><span class="pre">amp</span></code> and <code class="docutils literal notranslate"><span class="pre">phase</span></code>
will lead to an array of shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">*pts)</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.split_oscillator">
<span class="sig-name descname"><span class="pre">split_oscillator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oscillator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separation_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">estimate_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.split_oscillator" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits an oscillator in an estimation result into multiple oscillators.</p>
<p>Removes an oscillator, and incorporates two or more oscillators whose
cumulative amplitudes match that of the removed oscillator. Then runs
optimisation on the updated set of oscillators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oscillator</strong> (<em>int</em>) – The index of the oscillator to be split.</p></li>
<li><p><strong>index</strong> (<em>int</em>) – The index of the result to edit. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the
first result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the
next, etc. By default, the most recently obtained result will be
edited.</p></li>
<li><p><strong>separation_frequency</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>float</em><em>]</em><em>]</em>) – The frequency separation given to adjacent oscillators formed
from the splitting. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the splitting will be set to
<code class="docutils literal notranslate"><span class="pre">sw</span> <span class="pre">/</span> <span class="pre">n</span></code> in each dimension where <code class="docutils literal notranslate"><span class="pre">sw</span></code> is the sweep width and
<code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of points in the data.</p></li>
<li><p><strong>unit</strong> (<em>str</em>) – The unit that <code class="docutils literal notranslate"><span class="pre">separation_frequency</span></code> is expressed in.</p></li>
<li><p><strong>split_number</strong> (<em>int</em>) – The number of peaks to split the oscillator into.</p></li>
<li><p><strong>amp_ratio</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>float</em><em>]</em><em>]</em>) – The ratio of amplitudes to be fulfilled by the newly formed
peaks. If a list, <code class="docutils literal notranslate"><span class="pre">len(amp_ratio)</span> <span class="pre">==</span> <span class="pre">split_number</span></code> must be
satisfied. The first element will relate to the highest
frequency oscillator constructed, and the last element will
relate to the lowest frequency oscillator constructed. If <cite>None</cite>,
all oscillators will be given equal amplitudes.</p></li>
<li><p><strong>estimate_kwargs</strong> – Keyword arguments to provide to the call to <a class="reference internal" href="#nmrespy.Estimator2DJ.estimate" title="nmrespy.Estimator2DJ.estimate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimate()</span></code></a>. Note
that <code class="docutils literal notranslate"><span class="pre">&quot;initial_guess&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;region_unit&quot;</span></code> are set internally and
will be ignored if given.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.subband_estimate">
<span class="sig-name descname"><span class="pre">subband_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise_region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_region_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsubbands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss-newton'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpm_trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlp_trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.subband_estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.subband_estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform estiamtion on the entire signal via estimation of
frequency-filtered sub-bands.</p>
<p>This method splits the signal up into <code class="docutils literal notranslate"><span class="pre">nsubbands</span></code> equally-sized regions
in the direct dimension and extracts parameters from each region before
finally concatenating all the results together.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise_region</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Specifies a direct dimension frequency range where no noticeable
signals reside, i.e. only noise exists.</p></li>
<li><p><strong>noise_region_unit</strong> (<em>str</em>) – One of <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>. Specifies the units that <code class="docutils literal notranslate"><span class="pre">noise_region</span></code>
have been given in.</p></li>
<li><p><strong>nsubbands</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of sub-bands to break the signal into. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the number
will be set as the nearest integer to the data size divided by 500.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>Specifies the optimisation method.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;exact&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-trustconstr.html#optimize-minimize-trustconstr">trust-constr routine</a>
The Hessian will be exact.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;gauss-newton&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-trustconstr.html#optimize-minimize-trustconstr">trust-constr routine</a>
The Hessian will be approximated based on the
<a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Newton_algorithm">Gauss-Newton method</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;lbfgs&quot;</span></code> Uses SciPy’s
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-lbfgsb.html#optimize-minimize-lbfgsb">L-BFGS-B routine</a>.</p></li>
</ul>
</p></li>
<li><p><strong>phase_variance</strong> (<em>bool</em>) – Whether or not to include the variance of oscillator phases in the cost
function. This should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> in cases where the signal being
considered is derived from well-phased data.</p></li>
<li><p><strong>max_iterations</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – A value specifiying the number of iterations the routine may run
through before it is terminated. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default number
of maximum iterations is set (<code class="docutils literal notranslate"><span class="pre">100</span></code> if <code class="docutils literal notranslate"><span class="pre">method</span></code> is
<code class="docutils literal notranslate"><span class="pre">&quot;exact&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;gauss-newton&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">500</span></code> if <code class="docutils literal notranslate"><span class="pre">&quot;method&quot;</span></code> is
<code class="docutils literal notranslate"><span class="pre">&quot;lbfgs&quot;</span></code>).</p></li>
<li><p><strong>mpm_trim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Specifies the maximal size in the direct dimension allowed for the
filtered signal when undergoing the Matrix Pencil. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no
trimming is applied to the signal. If an int, and the filtered
signal has a direct dimension size greater than <code class="docutils literal notranslate"><span class="pre">mpm_trim</span></code>, this
signal will be set as <code class="docutils literal notranslate"><span class="pre">signal[:,</span> <span class="pre">:mpm_trim]</span></code>.</p></li>
<li><p><strong>nlp_trim</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Specifies the maximal size allowed in the direct dimension for the
filtered signal when undergoing nonlinear programming. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
no trimming is applied to the signal. If an int, and the filtered
signal has a direct dimension size greater than <code class="docutils literal notranslate"><span class="pre">nlp_trim</span></code>, this
signal will be set as <code class="docutils literal notranslate"><span class="pre">signal[:,</span> <span class="pre">:nlp_trim]</span></code>.</p></li>
<li><p><strong>fprint</strong> (<em>bool</em>) – Whether of not to output information to the terminal.</p></li>
<li><p><strong>_log</strong> (<em>bool</em>) – Ignore this!</p></li>
<li><p><strong>cut_ratio</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.sw">
<span class="sig-name descname"><span class="pre">sw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hz'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.sw" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the sweep width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unit</strong> (<em>str</em>) – Must be <code class="docutils literal notranslate"><span class="pre">&quot;hz&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ppm&quot;</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable</em>[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.to_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the estimator to a byte stream using Python’s pickling protocol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em>) – Path of file to save the byte stream to. <cite>‘.pkl’</cite> is added to the end of
the path if this is not given by the user. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">./estimator_&lt;x&gt;.pkl</span></code> will be used, where <code class="docutils literal notranslate"><span class="pre">&lt;x&gt;</span></code> is the first number
that doesn’t cause a clash with an already existent file.</p></li>
<li><p><strong>force_overwrite</strong> (<em>bool</em>) – <p>Defines behaviour if the specified path already exists:</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">force_overwrite</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the user will be prompted
if they are happy overwriting the current file.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">force_overwrite</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the current file will be
overwritten without prompt.</p></li>
</ul>
</p></li>
<li><p><strong>fprint</strong> (<em>bool</em>) – Specifies whether or not to print infomation to the terminal.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Estimator.from_pickle()</span></code></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.unicode_nuclei">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unicode_nuclei</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#nmrespy.Estimator2DJ.unicode_nuclei" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the nuclei associated with each channel with superscript numbers.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expinfo</span> <span class="o">=</span> <span class="n">ExpInfo</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">nuclei</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;1H&quot;</span><span class="p">,</span> <span class="s2">&quot;15N&quot;</span><span class="p">),</span> <span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expinfo</span><span class="o">.</span><span class="n">unicode_nuclei</span>
<span class="go">(&#39;¹H&#39;, &#39;¹⁵N&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.view_data">
<span class="sig-name descname"><span class="pre">view_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'freq'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/nmrespy/estimators/jres.html#Estimator2DJ.view_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nmrespy.Estimator2DJ.view_data" title="Permalink to this definition">¶</a></dt>
<dd><p>View the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain</strong> (<em>str</em>) – Must be <code class="docutils literal notranslate"><span class="pre">&quot;freq&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;time&quot;</span></code>.</p></li>
<li><p><strong>abs</strong> – Whether or not to display frequency-domain data in absolute-value mode.</p></li>
<li><p><strong>abs_</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nmrespy.Estimator2DJ.write_result">
<span class="sig-name descname"><span class="pre">write_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./nmrespy_result'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'txt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_figs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-2,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdflatex_exe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nmrespy.Estimator2DJ.write_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Write estimation results to text and PDF files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><em>int</em><em>]</em><em>]</em>) – The indices of results to include. Index <code class="docutils literal notranslate"><span class="pre">0</span></code> corresponds to the first
result obtained using the estimator, <code class="docutils literal notranslate"><span class="pre">1</span></code> corresponds to the next, etc.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all results will be included.</p></li>
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>Path</em><em>, </em><em>str</em><em>]</em>) – Path to save the result file to.</p></li>
<li><p><strong>fmt</strong> (<em>str</em>) – Must be one of <code class="docutils literal notranslate"><span class="pre">&quot;txt&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;pdf&quot;</span></code>.</p></li>
<li><p><strong>description</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – A description to add to the result file.</p></li>
<li><p><strong>sig_figs</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – The number of significant figures to give to parameters. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, the full value will be used.</p></li>
<li><p><strong>sci_lims</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – Given a value <code class="docutils literal notranslate"><span class="pre">(-x,</span> <span class="pre">y)</span></code>, for ints <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, any parameter <code class="docutils literal notranslate"><span class="pre">p</span></code>
with a value which satisfies <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&lt;</span> <span class="pre">10</span> <span class="pre">**</span> <span class="pre">-x</span></code> or <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">&gt;=</span> <span class="pre">10</span> <span class="pre">**</span> <span class="pre">y</span></code> will be
expressed in scientific notation, rather than explicit notation.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all values will be expressed explicitely.</p></li>
<li><p><strong>integral_mode</strong> (<em>str</em>) – One of <code class="docutils literal notranslate"><span class="pre">&quot;relative&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;absolute&quot;</span></code>. With <code class="docutils literal notranslate"><span class="pre">&quot;relative&quot;</span></code>, the smallest
integral will be set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, and all other integrals will be scaled
accordingly. With <code class="docutils literal notranslate"><span class="pre">&quot;absolute&quot;</span></code>, the absolute integral will be computed.
This should be used if you wish to directly compare different datasets.</p></li>
<li><p><strong>force_overwrite</strong> (<em>bool</em>) – If the file specified already exists, and this is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
user will be prompted to specify that they are happy overwriting the
current file.</p></li>
<li><p><strong>fprint</strong> (<em>bool</em>) – Specifies whether or not to print information to the terminal.</p></li>
<li><p><strong>pdflatex_exe</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em>) – <p>The path to the system’s <code class="docutils literal notranslate"><span class="pre">pdflatex</span></code> executable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You are unlikely to need to set this manually. It is primarily
present to specify the path to <code class="docutils literal notranslate"><span class="pre">pdflatex.exe</span></code> on Windows when
the NMR-EsPy GUI has been loaded from TopSpin.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><style>
.aligncenter {
    text-align: center;
}
</style>

<a href="https://foroozandehgroup.github.io/NMR-EsPy/">
    <img style="padding: 0px 0px 12px"
         src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/nmrespy_full.png"
         alt="NMR-EsPy logo"
         width=230px
         height=auto />
</a>

<p class="aligncenter">
    <a href="https://github.com/foroozandehgroup/NMR-EsPy">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/github.png"
             alt="Github"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

    <a href="mailto:simon.hulse@chem.ox.ac.uk?subject=NMR-EsPy%20query">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/master/nmrespy/images/email_icon.png"
             alt="email"
             style="padding: 0px 30px 0px 0px"
             width=auto
             height=30px />
    </a>

    <a href="https://foroozandeh.chem.ox.ac.uk/home">
        <img src="https://raw.githubusercontent.com/foroozandehgroup/NMR-EsPy/develop/nmrespy/images/link.png"
             alt="Group website"
             width=auto
             height=30px />
    </a>
</p><h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation index</a><ul>
  <li><a href="index.html">Reference</a><ul>
      <li>Previous: <a href="estimator1d.html" title="previous chapter">nmrespy.Estimator1D</a></li>
      <li>Next: <a href="load.html" title="next chapter">nmrespy.load</a></li>
  </ul></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/content/references/estimator2dj.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
  </body>
</html>